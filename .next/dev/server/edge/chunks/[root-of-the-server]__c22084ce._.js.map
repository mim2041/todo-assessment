{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/i18n/routing.js"],"sourcesContent":["import { defineRouting } from 'next-intl/routing';\n\nexport const routing = defineRouting({\n  // A list of all locales that are supported\n  locales: ['en', 'bn'],\n\n  // Used when no locale matches\n  defaultLocale: 'en',\n});\n"],"names":[],"mappings":";;;;AAAA;;AAEO,MAAM,UAAU,IAAA,2PAAa,EAAC;IACnC,2CAA2C;IAC3C,SAAS;QAAC;QAAM;KAAK;IAErB,8BAA8B;IAC9B,eAAe;AACjB"}},
    {"offset": {"line": 35, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/utils/helpers/verifyJWT.js"],"sourcesContent":["import { jwtDecode } from 'jwt-decode';\n\nexport async function verifyToken(token) {\n  if (!token) {\n    return false;\n  }\n  try {\n    const decoded = jwtDecode(token);\n    const currentTime = Math.floor(Date.now() / 1000);\n    if (decoded.exp && decoded.exp > currentTime) {\n      return true;\n    } else {\n      return false;\n    }\n  } catch (error) {\n    console.error(error);\n    return false;\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;;AAEO,eAAe,YAAY,KAAK;IACrC,IAAI,CAAC,OAAO;QACV,OAAO;IACT;IACA,IAAI;QACF,MAAM,UAAU,IAAA,2KAAS,EAAC;QAC1B,MAAM,cAAc,KAAK,KAAK,CAAC,KAAK,GAAG,KAAK;QAC5C,IAAI,QAAQ,GAAG,IAAI,QAAQ,GAAG,GAAG,aAAa;YAC5C,OAAO;QACT,OAAO;YACL,OAAO;QACT;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC;QACd,OAAO;IACT;AACF"}},
    {"offset": {"line": 62, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/middleware.ts"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-explicit-any */\nimport createIntlMiddleware from \"next-intl/middleware\";\nimport { NextResponse } from \"next/server\";\nimport { routing } from \"./i18n/routing\";\nimport { verifyToken } from \"./utils/helpers/verifyJWT\";\n\nconst intlMiddleware = createIntlMiddleware(routing);\n\n// Routes that require authentication\nconst PROTECTED_ROUTES = [\"/todos\", \"/profile\", \"/settings\", \"/dashboard\"];\n\n// Routes that should redirect to dashboard if already authenticated\nconst AUTH_ONLY_ROUTES = [\"/login\", \"/signup\"];\n\nexport async function middleware(request: any) {\n    const { pathname } = request.nextUrl;\n    const accessToken = request.cookies.get(\"accessToken\")?.value;\n    const refreshToken = request.cookies.get(\"refreshToken\")?.value;\n\n    // Check if pathname is missing locale\n    const pathnameIsMissingLocale = routing.locales.every(\n        (locale) =>\n            !pathname.startsWith(`/${locale}/`) && pathname !== `/${locale}`\n    );\n\n    // Get clean pathname without locale prefix\n    const cleanPathname = pathnameIsMissingLocale\n        ? pathname\n        : pathname.replace(/^\\/[^\\/]+/, \"\");\n\n    // Get current locale\n    const locale = pathnameIsMissingLocale\n        ? routing.defaultLocale\n        : pathname.split(\"/\")[1];\n\n    let isAuthenticated = false;\n    let response: NextResponse | null = null;\n\n    // Verify access token\n    if (accessToken) {\n        isAuthenticated = await verifyToken(accessToken);\n    }\n\n    // If access token invalid, try refresh token\n    if (!isAuthenticated && refreshToken) {\n        const refreshResult = await verifyToken(refreshToken);\n        if (refreshResult) {\n            isAuthenticated = true;\n        } else {\n            // Both tokens invalid, clear cookies\n            response = NextResponse.next();\n            response.cookies.delete(\"accessToken\");\n            response.cookies.delete(\"refreshToken\");\n        }\n    }\n\n    // Protect routes that require authentication\n    if (\n        PROTECTED_ROUTES.some((route) => cleanPathname.startsWith(route)) &&\n        !isAuthenticated\n    ) {\n        const loginUrl = request.nextUrl.clone();\n        loginUrl.pathname = `/${locale}/login`;\n        loginUrl.searchParams.set(\"callbackUrl\", pathname);\n\n        const redirectResponse = NextResponse.redirect(loginUrl);\n        // Clear invalid cookies\n        redirectResponse.cookies.delete(\"accessToken\");\n        redirectResponse.cookies.delete(\"refreshToken\");\n        return redirectResponse;\n    }\n\n    // Redirect authenticated users away from auth pages to dashboard\n    if (\n        isAuthenticated &&\n        AUTH_ONLY_ROUTES.some((route) => cleanPathname.startsWith(route))\n    ) {\n        const dashboardUrl = request.nextUrl.clone();\n        dashboardUrl.pathname = `/${locale}/todos`;\n        dashboardUrl.searchParams.delete(\"callbackUrl\");\n\n        return response\n            ? NextResponse.redirect(dashboardUrl, { headers: response.headers })\n            : NextResponse.redirect(dashboardUrl);\n    }\n\n    // Continue with i18n middleware or return modified response\n    return response || intlMiddleware(request);\n}\n\nexport const config = {\n    matcher: [\"/((?!_next/static|_next/image|favicon.ico|.*\\\\..*|api|trpc).*)\"],\n};\n"],"names":[],"mappings":"AAAA,qDAAqD;;;;;;AACrD;AACA;AAAA;AACA;AACA;;;;;AAEA,MAAM,iBAAiB,IAAA,yMAAoB,EAAC,yIAAO;AAEnD,qCAAqC;AACrC,MAAM,mBAAmB;IAAC;IAAU;IAAY;IAAa;CAAa;AAE1E,oEAAoE;AACpE,MAAM,mBAAmB;IAAC;IAAU;CAAU;AAEvC,eAAe,WAAW,OAAY;IACzC,MAAM,EAAE,QAAQ,EAAE,GAAG,QAAQ,OAAO;IACpC,MAAM,cAAc,QAAQ,OAAO,CAAC,GAAG,CAAC,gBAAgB;IACxD,MAAM,eAAe,QAAQ,OAAO,CAAC,GAAG,CAAC,iBAAiB;IAE1D,sCAAsC;IACtC,MAAM,0BAA0B,yIAAO,CAAC,OAAO,CAAC,KAAK,CACjD,CAAC,SACG,CAAC,SAAS,UAAU,CAAC,CAAC,CAAC,EAAE,OAAO,CAAC,CAAC,KAAK,aAAa,CAAC,CAAC,EAAE,QAAQ;IAGxE,2CAA2C;IAC3C,MAAM,gBAAgB,0BAChB,WACA,SAAS,OAAO,CAAC,aAAa;IAEpC,qBAAqB;IACrB,MAAM,SAAS,0BACT,yIAAO,CAAC,aAAa,GACrB,SAAS,KAAK,CAAC,IAAI,CAAC,EAAE;IAE5B,IAAI,kBAAkB;IACtB,IAAI,WAAgC;IAEpC,sBAAsB;IACtB,IAAI,aAAa;QACb,kBAAkB,MAAM,IAAA,2JAAW,EAAC;IACxC;IAEA,6CAA6C;IAC7C,IAAI,CAAC,mBAAmB,cAAc;QAClC,MAAM,gBAAgB,MAAM,IAAA,2JAAW,EAAC;QACxC,IAAI,eAAe;YACf,kBAAkB;QACtB,OAAO;YACH,qCAAqC;YACrC,WAAW,gMAAY,CAAC,IAAI;YAC5B,SAAS,OAAO,CAAC,MAAM,CAAC;YACxB,SAAS,OAAO,CAAC,MAAM,CAAC;QAC5B;IACJ;IAEA,6CAA6C;IAC7C,IACI,iBAAiB,IAAI,CAAC,CAAC,QAAU,cAAc,UAAU,CAAC,WAC1D,CAAC,iBACH;QACE,MAAM,WAAW,QAAQ,OAAO,CAAC,KAAK;QACtC,SAAS,QAAQ,GAAG,CAAC,CAAC,EAAE,OAAO,MAAM,CAAC;QACtC,SAAS,YAAY,CAAC,GAAG,CAAC,eAAe;QAEzC,MAAM,mBAAmB,gMAAY,CAAC,QAAQ,CAAC;QAC/C,wBAAwB;QACxB,iBAAiB,OAAO,CAAC,MAAM,CAAC;QAChC,iBAAiB,OAAO,CAAC,MAAM,CAAC;QAChC,OAAO;IACX;IAEA,iEAAiE;IACjE,IACI,mBACA,iBAAiB,IAAI,CAAC,CAAC,QAAU,cAAc,UAAU,CAAC,SAC5D;QACE,MAAM,eAAe,QAAQ,OAAO,CAAC,KAAK;QAC1C,aAAa,QAAQ,GAAG,CAAC,CAAC,EAAE,OAAO,MAAM,CAAC;QAC1C,aAAa,YAAY,CAAC,MAAM,CAAC;QAEjC,OAAO,WACD,gMAAY,CAAC,QAAQ,CAAC,cAAc;YAAE,SAAS,SAAS,OAAO;QAAC,KAChE,gMAAY,CAAC,QAAQ,CAAC;IAChC;IAEA,4DAA4D;IAC5D,OAAO,YAAY,eAAe;AACtC;AAEO,MAAM,SAAS;IAClB,SAAS;QAAC;KAAiE;AAC/E"}}]
}